% Zustandsraumreduziertes Modell 4. Ordnung Hinterachsprüfstand
%Roth,H. Ein neues Verfahren zur Ordnungsreduktion und 
%Reglerentwurf auf der Basis des reduzierten Modells.
%Fortschritt-Bericht der VDI-Zeitschriften, Reihe 8, Nr.69,
%VDI-Verlag Düsseldorf
%Eigenwerte der instatilen Systemmatrix A
%  14.3378 +30.7923i
%  14.3378 -30.7923i
%  25.1322 + 0.0000i
%  -5.2798 + 0.0000i
%
A=[ -16.97 -1.976  8.722  8.773;
    190.4  4.798 -103.6 -91.36;
   -73.89 -1.325  31.4   42.60;
	49.29  1.610 -20.95  29.3];
%
B=[ 1.249  0.001  0.019;
   -2.183 -1.837  2.649;
    5.250 -1.618  2.460;
   -3.307  1.315 -1.634];
%
C=[ 1 0 0 0;
   0 1 0 0;
   0 0 1 0;
   0 0 0 1];
%
% Wichtungsmatrizen
Q=diag([ 1 1 1 1]);
%
V=diag([ 1 1 1 1]);
%
R=diag([ 1 1 1]);
%  
% Startmatrix K
K=[ 0.5204    0.2247   -2.2412  -26.4143;
    3.1282   -0.5049    0.4407   11.7458;
   -5.7691    0.5562    0.4249  -13.4387];
%
% Eigenwerte von Ag = A-B*K*C
% -16.5026 +32.8439i
% -16.5026 -32.8439i
%  -5.5229 + 0.0000i
% -28.7203 + 0.0000i
%
% Kf = [0 2 2 1;
%      2 0 0 2;
%      1 2 2 0];
% K=[-3.2154    0.0000   -0.0000  -23.8416;
%    0.0000   -0.2329    0.5051    0.0000;
%   -4.3994    0.0000    0.0000  -14.0042];
% Q=0.1*[
%    0.0756    0.0257    0.3338    0.4803;
%    0.0257    0.0073    0.0930    0.1393;
%    0.3338    0.0930    1.1389    1.7091;
%    0.4803    0.1393    1.7091    2.5379];
%
% Uk = 10000*ones(12);
% P = pinv(B*B')*B*R*K ; 
%
% Q = -A'*P' - P*A + P*B*inv(R)*B'*P'
%
% DFP L=47142 Kuhn
% K = [
%   -2.3741         0         0  -20.3603;
%    2.8993         0         0    8.5176;
%   -3.9942         0         0  -11.8901];
% Q=   0.00001* [
%   0.3449    0.0493    0.4349   -0.7215;
%   0.0493    0.0572    0.3367   -0.2980;
%   0.4349    0.3367    2.6640   -2.3382;
%  -0.7215   -0.2980   -2.3382    2.4800 ];    
% Eigenwerte von Ag = A-B*K*C
% -15.0092 +32.7247i
% -15.0092 -32.7247i
%  -8.1880 + 6.1371i
%  -8.1880 - 6.1371i
%