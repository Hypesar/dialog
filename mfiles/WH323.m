% Mehrgrößenreglerentwurf im Zustandsraum
% Prof. Dr.-Ing. U. Konigorski
% Script - Wintersemester 2014/2015
% Simulation 3-Tanksystem Kap. 3.5 S.22
% https://www.arndt-bruenner.de/mathe/scripts/eigenwert2.htm
%T=[ 0,761988198540932; -1,6007361691096187; 1; % zum Eigenwert -6,201472338219242:
%   -0,8345395441411443; 0,2274520456117616; 1; %  zum Eigenwert -2,545095908776476:
%    1,5725513456002111; 1,3732841234978586; 1]; % zum Eigenwert -0,25343175300428267:

A  = [ -2  2  0;
        2 -4  2;
        0  2 -3];
    
B  = [ 0.5    0;
       0      0;
       0   0.5];
   
C  = [ 1  0   0;
       0  1   0;
       0  0   1];
   
K  = zeros(2,3);

K = [
    4.0000    4.0000   -0.0000 ;
   -0.0000    4.0000    2.0000 ];

X=pinv(B*B')*B*K*C;

Q = -A'*X - X*A + X*B*B'*X;

L = diag([-1 -3 -7]);
L = diag([-4 -4 -4]);
%L = diag([-6 -4 -2]);
%L = diag([-4 -4 -5]);
%L = diag([-4 -5 -6]);
%L = diag([-1 -3 -6]);
%L = diag([-8 -4.5 -1.5]);
%L = diag([-6 -4 -2]);
%L = diag([-7 -5 -2]);
%L = diag([-1 -4 -7]);
%L = diag([-7 -4 -1]);
%L = diag([-6.2 -2.5 -9.25]);


%L = diag([-6.2015 -2.5451 -0.2534]);
Kf =[ 0 2 0; 2 0 2];
% Kf =[ 2 0 2;0 2 0];  

%Kf = [0 0 0;2 2 2];
%Kf = [2 2 2;0 0 0];
%Kf =[ 2 0 2;
%      0 2 0]; 
Q= diag([ 1 1 1 ]);

V= diag([ 1 1 1 ]);
R= diag([ 1 1 ]);

%L = diag([-4 -4 -4]);


Q=[ 32.0000   48.0000  -16.0000;
   -16.0000  -32.0000   -8.0000;
   -16.0000   56.0000   12.0000];

Q=[ 16.0000   40.0000  -32.0000;
    40.0000   -0.0000   48.0000;
   -32.0000   48.0000   -4.0000];
    


Q=[16.0000   39.7500  -32.0000;
   39.7500    1.0000   47.7500;
  -32.0000   47.7500   -4.0000];

%L = diag([-7 -1 -4]);
Q=[-44.0000   40.0000  -32.0000;
    40.0000   -0.0000   48.0000;
   -32.0000   48.0000  128.0000];

Q=[ 16.0000   40.0000  -32.0000;
    40.0000   -0.0000   48.0000;
   -32.0000   48.0000   -4.0000];

Q= diag([ 1 1 1 ]);

eig(A-B*K*C)








